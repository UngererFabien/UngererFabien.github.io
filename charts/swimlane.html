<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="./styles/styles.css">

  <script type="text/javascript" src="./js/libs/jquery-2.1.3.js"></script>
  <script type="text/javascript" src="./js/libs/underscore.js"></script>
  <script type="text/javascript" src="./js/libs/d3/d3.js"></script>
  <script type="text/javascript" src="./js/libs/d3/d3.chart.js"></script>

  <script type="text/javascript" src="./js/SwimLane.js"></script>
</head>
<body>
  <div class="chart" style="width: 1400px"></div>

  <script type="text/javascript">
    var chart = d3.select('.chart')
        .append('svg')
          .attr('width', 1400)
          .attr('height', 400)
          .chart('SwimLaneChart');

    function rData () {
      var lanes = [];

      for (var i = 0; i < 10; i++) {
        var lane = {
          id: '_'+i,
          events: []
        }

        var nbEvents = Math.round(Math.random()*60);

        for (var j = 0; j < nbEvents; j++) {
          lane.events.push({
            start: j*10+5,
            end: j*10+15,
            name: '_'+i+'_'+j
          });
        }

        lanes.push(lane);
      }

      return lanes;
    };

    // var dataset = rData();
    // // console.log(dataset);
    // chart.draw(dataset);

    d3.json('./json/G2_jungle.json', function (err, games) {
      var lanes = [];

      for (var i = 0; i < games.length; i++) {
        var game = games[i];

        var lane = {events: []};

        for(var timer in game) {
          if(timer == 'team') {
            lane.id = game[timer];
          } else {
            var timerArr = timer.split(':');
            var eventSeconds =  timerArr[0]*60+(+timerArr[1]);
            // console.log(timer, eventSeconds);

            lane.events.push({
              start: eventSeconds,
              end: eventSeconds+15,
              name: game[timer]
            });
          }
        }

        lanes.push(lane);
      }

      chart.draw(lanes);
    })

  </script>
</body>
</html>